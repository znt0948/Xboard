"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[396],{12321:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(20641),s=n(90033),l={key:0,class:"spinner-text"};const r={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const u=(0,n(66262).A)(r,[["render",function(e,t,n,r,u,i){return(0,a.uX)(),(0,a.CE)("div",{class:(0,s.C4)(["loading-spinner",{"loading-spinner-overlay":n.overlay}])},[t[0]||(t[0]=(0,a.Lk)("div",{class:"spinner"},[(0,a.Lk)("div",{class:"spinner-circle"})],-1)),n.text?((0,a.uX)(),(0,a.CE)("div",l,(0,s.v_)(n.text),1)):(0,a.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])},46510:(e,t,n)=>{n.d(t,{F$:()=>s,Hi:()=>i,RV:()=>u,Z2:()=>l,yN:()=>r});var a=n(19043);function s(){return(0,a.A)({url:"/user/ticket/fetch",method:"get"})}function l(e){return(0,a.A)({url:"/user/ticket/save",method:"post",data:e})}function r(e){return(0,a.A)({url:"/user/ticket/fetch?id=".concat(e),method:"get"})}function u(e,t){return(0,a.A)({url:"/user/ticket/reply",method:"post",data:{id:e,message:t}})}function i(e){return(0,a.A)({url:"/user/ticket/close",method:"post",data:{id:e}})}},60015:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ze});var a=n(90208),s=n(78676),l=n(20908),r=n(41034),u=n(30388),i=(n(16280),n(76918),n(28706),n(2008),n(23418),n(74423),n(64346),n(62062),n(44114),n(34782),n(59089),n(23288),n(18111),n(22489),n(61701),n(2892),n(26099),n(58940),n(99449),n(21699),n(47764),n(11392),n(42762),n(62953),n(76031),n(20641)),c=n(50953),o=n(90033),v=n(53751),d=n(46992),p=n(75220),k=n(33263),f=n(25226),m=n(12321),g=n(33366),b=n(46510),y=n(92549),h=n(49586),L=n(80394),C=n(69668),w={class:"mobile-ticket-container"},_={key:0,class:"screen-size-notice"},A={class:"notice-content"},R={class:"dashboard-card welcome-card"},E={class:"card-header"},X={class:"card-title"},$={class:"card-body"},T={key:0,class:"ticket-list"},I={class:"create-ticket-wrapper"},K={key:0,class:"loading-state"},F={key:1,class:"tickets-content"},S=["onClick"],x={class:"ticket-header"},D={class:"ticket-subject"},W={class:"ticket-info"},z={class:"ticket-time"},M={class:"ticket-id"},j={key:2,class:"empty-state"},N={key:1,class:"ticket-detail"},H={class:"detail-header"},P={class:"ticket-info"},G={class:"meta-info"},O={class:"messages-container"},Q={key:0,class:"loading-state"},B={key:1,class:"empty-messages"},V={key:2,class:"message-list"},U={class:"message-avatar"},Y={class:"message-content"},J={class:"message-header"},q={class:"sender-name"},Z={class:"message-time"},ee=["innerHTML"],te={key:0,class:"reply-box"},ne=["placeholder","onKeydown"],ae={class:"reply-tools",style:{display:"flex",gap:"8px","align-items":"center","justify-content":"flex-end"}},se=["disabled"],le={key:1,class:"loader"},re={key:2},ue={key:3},ie=["disabled"],ce={key:0,class:"loader"},oe={key:1,class:"ticket-closed-notice"},ve={class:"modal-header"},de={class:"modal-body"},pe={class:"form-group"},ke=["placeholder"],fe={class:"form-group"},me={class:"priority-selector"},ge=["onClick"],be={class:"form-group"},ye=["placeholder"],he={class:"upload-tip"},Le={class:"upload-tip-text"},Ce={class:"upload-desc"},we={key:1,style:{"margin-top":"8px",color:"#2196f3"}},_e={key:2,style:{"margin-top":"8px"}},Ae=["onClick"],Re=["src"],Ee={class:"modal-footer"},Xe=["disabled"],$e={key:0,class:"loader"},Te={class:"modal-header"},Ie={class:"modal-body"},Ke={class:"modal-footer"},Fe=["disabled"],Se={key:0},xe={key:1,class:"btn-loading"},De="https://api.imgbb.com/1/upload";const We={__name:"MobileTicketList",setup:function(e){var t=new k.A({linkify:!0,breaks:!0}),n=(0,d.s9)().t,We=(0,g.d)().showToast,ze=(0,p.rd)(),Me=(0,c.KR)(!1),je=(0,c.KR)([]),Ne=(0,c.KR)(!1),He=(0,c.KR)(!1),Pe=(0,c.KR)(null),Ge=(0,c.KR)([]),Oe=(0,c.KR)(!1),Qe=(0,c.KR)(""),Be=(0,c.KR)(!1),Ve=(0,c.KR)(!1),Ue=(0,c.KR)(!1),Ye=(0,c.KR)(null),Je=(0,c.KR)({subject:"",message:"",level:0}),qe=(0,c.KR)(!1),Ze=(0,c.KR)(!1),et=(null===L.TICKET_CONFIG||void 0===L.TICKET_CONFIG?void 0:L.TICKET_CONFIG.popup)||{},tt=function(){qe.value=window.innerWidth>=905},nt=function(){ze.push("/tickets")};(0,i.sV)(function(){tt(),window.addEventListener("resize",tt),dt(),bt()}),(0,i.hi)(function(){window.removeEventListener("resize",tt),it()});var at=function(e){var t={0:n("tickets.levelLow"),1:n("tickets.levelMedium"),2:n("tickets.levelHigh")};return t[e]||t[0]},st=function(e){if(!e)return"--";var t=new Date(1e3*e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{month:"short",day:"numeric"})+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},lt=function(){Ne.value=!0},rt=function(){var e=document.querySelector(".modal-content");e?(e.classList.add("closing"),setTimeout(function(){Ne.value=!1,Je.value={subject:"",message:"",level:0}},300)):(Ne.value=!1,Je.value={subject:"",message:"",level:0})},ut=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var a,s,u,i,c=arguments;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return(a=c.length>1&&void 0!==c[1]&&c[1])||(Oe.value=!0,Ge.value=[]),e.p=1,e.n=2,(0,b.yN)(t);case 2:(s=e.v).data&&(s.data.message&&Array.isArray(s.data.message)?Ge.value=s.data.message.map(function(e){return(0,r.A)((0,r.A)({},e),{},{is_admin:!e.is_me})}):Ge.value=[],Pe.value&&Pe.value.id===t&&void 0!==s.data.status&&(Pe.value.status=s.data.status,1===s.data.status&&it())),e.n=4;break;case 3:e.p=3,i=e.v,We((null===(u=i.response)||void 0===u?void 0:u.message)||i.message||n("tickets.fetchDetailError"),"error");case 4:return e.p=4,a||(Oe.value=!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),it=function(){Ye.value&&(clearInterval(Ye.value),Ye.value=null)},ct=function(e){it(),Pe.value&&0===Pe.value.status&&(Ye.value=setInterval(function(){Pe.value&&Pe.value.id===e?ut(e,!0):it()},5e3))},ot=function(){var e=(0,u.A)((0,l.A)().m(function e(t){return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:return it(),Pe.value=t,e.n=1,ut(t.id);case 1:0===t.status&&ct(t.id);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),vt=function(){it();var e=document.querySelector(".ticket-detail");e?(e.classList.add("closing"),setTimeout(function(){Pe.value=null},280)):Pe.value=null},dt=function(){var e=(0,u.A)((0,l.A)().m(function e(){var t,a,s;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return Me.value=!0,e.p=1,e.n=2,(0,b.F$)();case 2:t=e.v,je.value=Array.isArray(t.data)?t.data:[],e.n=4;break;case 3:e.p=3,s=e.v,We((null===(a=s.response)||void 0===a?void 0:a.message)||s.message||n("tickets.fetchError"),"error");case 4:return e.p=4,Me.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=(0,u.A)((0,l.A)().m(function e(){var t,a,s;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Qe.value.trim()&&Pe.value&&!Be.value){e.n=1;break}return e.a(2);case 1:return Be.value=!0,e.p=2,e.n=3,(0,b.RV)(Pe.value.id,Qe.value);case 3:if(!(t=e.v).data){e.n=4;break}return We(t.message||n("tickets.replySent"),"success"),Qe.value="",e.n=4,ut(Pe.value.id,!0);case 4:e.n=6;break;case 5:e.p=5,s=e.v,We((null===(a=s.response)||void 0===a?void 0:a.message)||s.message||n("tickets.replyError"),"error");case 6:return e.p=6,Be.value=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),kt=function(){Ve.value=!0},ft=function(){var e=document.querySelector(".modal-content");e?(e.classList.add("closing"),setTimeout(function(){Ve.value=!1,Ue.value=!1},300)):(Ve.value=!1,Ue.value=!1)},mt=function(){var e=(0,u.A)((0,l.A)().m(function e(){var t,a,s;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Pe.value){e.n=1;break}return e.a(2);case 1:return Ue.value=!0,e.p=2,e.n=3,(0,b.Hi)(Pe.value.id);case 3:if(!0!==(t=e.v).data){e.n=5;break}return We(t.message||n("tickets.closeSuccess"),"success"),Ve.value=!1,Pe.value.status=1,e.n=4,dt();case 4:it(),vt();case 5:e.n=7;break;case 6:e.p=6,s=e.v,We((null===(a=s.response)||void 0===a?void 0:a.message)||s.message||n("tickets.closeError"),"error");case 7:return e.p=7,Ue.value=!1,e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=(0,u.A)((0,l.A)().m(function e(){var t,a,r,u,i,c,o,v,d,p,k;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Je.value.subject&&Je.value.message){e.n=1;break}return We(n("tickets.formIncomplete"),"error"),e.a(2);case 1:if(He.value=!0,e.p=2,t=Je.value.message,!L.TICKET_CONFIG.includeUserInfoInTicket){e.n=4;break}return e.n=3,Promise.all([(0,y.ug)(),(0,y.l8)(),(0,y._8)(),(0,y.XL)()]);case 3:a=e.v,r=(0,s.A)(a,4),u=r[0],i=r[1],c=r[2],o=r[3],i&&i.data&&i.data.currency_symbol&&(u.currency_symbol=i.data.currency_symbol),v=(0,h.AB)(u,o,c),t="".concat(Je.value.message,"\n\n").concat(v);case 4:return e.n=5,(0,b.Z2)({subject:Je.value.subject,message:t,level:parseInt(Je.value.level)});case 5:if(!(d=e.v).data){e.n=7;break}return We(d.message||n("tickets.createSuccess"),"success"),rt(),e.n=6,dt();case 6:Je.value={subject:"",message:"",level:"0"};case 7:e.n=9;break;case 8:e.p=8,k=e.v,We((null===(p=k.response)||void 0===p?void 0:p.message)||k.message||n("tickets.createError"),"error");case 9:return e.p=9,He.value=!1,e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),bt=function(){if(et.enabled){var e=Number(localStorage.getItem("ticket_popup_close_time")||0),t=3600*(et.cooldownHours||0)*1e3;(!e||Date.now()-e>=t)&&(Ze.value=!0)}},yt=function(){Ze.value=!1};dt();var ht=(0,c.KR)([]),Lt=(0,c.KR)(!1),Ct=(0,c.KR)(!1),wt=(0,c.KR)(null),_t=(0,c.KR)(null),At=(0,c.KR)(0),Rt=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var n,a,s,r,u,c,o,v;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if(r=_t.value,u=Je.value.message||"",r){e.n=1;break}return Je.value.message=u+(u&&!u.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return c=null!==(n=null!==(a=r.selectionStart)&&void 0!==a?a:At.value)&&void 0!==n?n:u.length,o=null!==(s=r.selectionEnd)&&void 0!==s?s:c,Je.value.message=u.slice(0,c)+t+u.slice(o),e.n=2,(0,i.dY)();case 2:v=c+t.length,r.focus(),r.setSelectionRange(v,v),At.value=v;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Et=L.TICKET_CONFIG.imgbbApiKey,Xt=function(){wt.value&&wt.value.click()},$t=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var n;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if(Ct.value=!1,!(n=Array.from(t.dataTransfer.files).filter(function(e){return e.type.startsWith("image/")})).length){e.n=1;break}return e.n=1,Tt({target:{files:n}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Tt=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var n,s,r,u;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if((n=Array.from(t.target.files)).length){e.n=1;break}return e.a(2);case 1:Lt.value=!0,s=(0,l.A)().m(function e(){var t,n,a,s,i,c;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!((t=u[r]).size>5242880)){e.n=1;break}return We("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(2,1);case 1:return e.p=1,e.n=2,new Promise(function(e,n){var a=new FileReader;a.onload=function(){return e(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(t)});case 2:return n=e.v,(a=new FormData).append("image",n),e.n=3,fetch("".concat(De,"?key=").concat(Et),{method:"POST",body:a});case 3:return s=e.v,e.n=4,s.json();case 4:(i=e.v).success&&i.data&&i.data.url?(ht.value.push(i.data.url),Je.value.message+="\n![image](".concat(i.data.url,")")):We((null===(c=i.error)||void 0===c?void 0:c.message)||"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25","error"),e.n=6;break;case 5:e.p=5,e.v,We("\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 6:return e.a(2)}},e,null,[[1,5]])}),r=0,u=n;case 2:if(!(r<u.length)){e.n=5;break}return e.d((0,a.A)(s()),3);case 3:if(!e.v){e.n=4;break}return e.a(3,4);case 4:r++,e.n=2;break;case 5:Lt.value=!1;case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),It=(0,c.KR)(null),Kt=(0,c.KR)(null),Ft=(0,c.KR)(!1),St=(0,c.KR)(0),xt=function(){It.value&&It.value.click()},Dt=function(){var e,t=Kt.value;t&&(St.value=null!==(e=t.selectionStart)&&void 0!==e?e:Qe.value.length)},Wt=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var n,a,s,r,u,c,o,v;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if(r=Kt.value,u=Qe.value||"",r){e.n=1;break}return Qe.value=u+(u&&!u.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return c=null!==(n=null!==(a=r.selectionStart)&&void 0!==a?a:St.value)&&void 0!==n?n:u.length,o=null!==(s=r.selectionEnd)&&void 0!==s?s:c,Qe.value=u.slice(0,c)+t+u.slice(o),e.n=2,(0,i.dY)();case 2:v=c+t.length,r.focus(),r.setSelectionRange(v,v),St.value=v;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),zt=function(e){return new Promise(function(t,n){var a=new FileReader;a.onload=function(){return t(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(e)})},Mt=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var n,a,s,r,u,i;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,zt(t);case 1:return s=e.v,(r=new FormData).append("image",s),e.n=2,fetch("".concat(De,"?key=").concat(Et),{method:"POST",body:r});case 2:return u=e.v,e.n=3,u.json();case 3:if(!(i=e.v).success||null===(n=i.data)||void 0===n||!n.url){e.n=4;break}return e.a(2,i.data.url);case 4:throw new Error((null===(a=i.error)||void 0===a?void 0:a.message)||"imgbb \u4e0a\u4f20\u5931\u8d25");case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),jt=function(){var e=(0,u.A)((0,l.A)().m(function e(t){var a,s,r,u,i,c,o;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if((a=Array.from(t.target.files||[])).length){e.n=1;break}return e.a(2);case 1:Ft.value=!0,e.p=2,s=0,r=a;case 3:if(!(s<r.length)){e.n=7;break}if(!((u=r[s]).size>5242880)){e.n=4;break}return We("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(3,6);case 4:return e.n=5,Mt(u);case 5:return i=e.v,c="![image](".concat(i,")"),e.n=6,Wt(c);case 6:s++,e.n=3;break;case 7:We(n("tickets.uploadSuccess")||"\u56fe\u7247\u4e0a\u4f20\u6210\u529f","success"),e.n=9;break;case 8:e.p=8,o=e.v,We(o.message||"\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 9:return e.p=9,Ft.value=!1,It.value&&(It.value.value=""),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(t){return e.apply(this,arguments)}}();return function(e,n){return(0,i.uX)(),(0,i.CE)("div",w,[qe.value?((0,i.uX)(),(0,i.CE)("div",_,[(0,i.Lk)("div",A,[(0,i.bF)((0,c.R1)(f.vk8),{size:48}),(0,i.Lk)("h2",null,(0,o.v_)(e.$t("tickets.largeScreenNotice")),1),(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.switchToDesktop")),1),(0,i.Lk)("button",{class:"switch-btn",onClick:nt},(0,o.v_)(e.$t("tickets.switchToDesktopView")),1)])])):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",R,[(0,i.Lk)("div",E,[(0,i.Lk)("h2",X,(0,o.v_)(e.$t("tickets.title")),1)]),(0,i.Lk)("div",$,[(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.description")),1)])]),Pe.value?((0,i.uX)(),(0,i.CE)("div",N,[(0,i.Lk)("div",H,[(0,i.Lk)("button",{class:"back-btn",onClick:vt},[(0,i.bF)((0,c.R1)(f.Gk),{size:20})]),(0,i.Lk)("div",P,[(0,i.Lk)("h2",null,(0,o.v_)(Pe.value.subject),1),(0,i.Lk)("div",G,[(0,i.Lk)("span",{class:(0,o.C4)(["status-badge","status-".concat(Pe.value.status)])},(0,o.v_)(0===Pe.value.status?e.$t("tickets.statusOpen"):e.$t("tickets.statusClosed")),3),(0,i.Lk)("span",{class:(0,o.C4)(["level-badge","level-".concat(Pe.value.level)])},(0,o.v_)(at(Pe.value.level)),3)])]),0===Pe.value.status?((0,i.uX)(),(0,i.CE)("button",{key:0,class:"close-ticket-btn",onClick:kt},[(0,i.bF)((0,c.R1)(f.MRt),{size:16})])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",O,[Oe.value?((0,i.uX)(),(0,i.CE)("div",Q,[(0,i.bF)(m.A),(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.loadingMessages")),1)])):0===Ge.value.length?((0,i.uX)(),(0,i.CE)("div",B,[(0,i.bF)((0,c.R1)(f.bYO),{size:48}),(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.noMessages")),1)])):((0,i.uX)(),(0,i.CE)("div",V,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Ge.value,function(n){return(0,i.uX)(),(0,i.CE)("div",{key:n.id,class:(0,o.C4)(["message-item",n.is_admin?"admin-message":"user-message"])},[(0,i.Lk)("div",U,[n.is_admin?((0,i.uX)(),(0,i.Wv)((0,c.R1)(f.ut_),{key:0})):((0,i.uX)(),(0,i.Wv)((0,c.R1)(f.vg7),{key:1}))]),(0,i.Lk)("div",Y,[(0,i.Lk)("div",J,[(0,i.Lk)("span",q,(0,o.v_)(n.is_admin?e.$t("tickets.admin"):e.$t("tickets.you")),1),(0,i.Lk)("span",Z,(0,o.v_)(st(n.created_at)),1)]),(0,i.Lk)("div",{class:"message-text",innerHTML:(0,c.R1)(t).render(n.message)},null,8,ee)])],2)}),128))]))]),0===Pe.value.status?((0,i.uX)(),(0,i.CE)("div",te,[(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":n[0]||(n[0]=function(e){return Qe.value=e}),placeholder:e.$t("tickets.replyPlaceholder"),rows:"3",onKeydown:(0,v.jR)((0,v.D$)(pt,["ctrl"]),["enter"]),onKeyup:Dt,onClick:Dt},null,40,ne),[[v.Jo,Qe.value]]),(0,i.Lk)("div",ae,[(0,i.Lk)("button",{class:"send-btn",type:"button",onClick:xt,disabled:Ft.value},[Ft.value?((0,i.uX)(),(0,i.CE)("span",le)):((0,i.uX)(),(0,i.Wv)((0,c.R1)(f.GYm),{key:0,size:18})),Ft.value?((0,i.uX)(),(0,i.CE)("span",ue,(0,o.v_)(e.$t("tickets.uploadingImages")||"\u4e0a\u4f20\u4e2d"),1)):((0,i.uX)(),(0,i.CE)("span",re,(0,o.v_)(e.$t("tickets.upPictures")||"\u4e0a\u4f20\u56fe\u7247"),1))],8,se),(0,i.Lk)("button",{class:"send-btn",onClick:pt,disabled:!Qe.value.trim()||Be.value},[Be.value?((0,i.uX)(),(0,i.CE)("span",ce)):((0,i.uX)(),(0,i.Wv)((0,c.R1)(f.mDt),{key:1,size:18})),(0,i.eW)(" "+(0,o.v_)(e.$t("tickets.send")),1)],8,ie)]),(0,i.Lk)("input",{ref_key:"replyImageInput",ref:It,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:jt},null,544)])):((0,i.uX)(),(0,i.CE)("div",oe,[(0,i.bF)((0,c.R1)(f.XEb),{size:20}),(0,i.Lk)("span",null,(0,o.v_)(e.$t("tickets.ticketClosed")),1)]))])):((0,i.uX)(),(0,i.CE)("div",T,[(0,i.Lk)("div",I,[(0,i.Lk)("button",{class:"new-ticket-btn",onClick:lt},[(0,i.bF)((0,c.R1)(f.uID),{size:18}),(0,i.eW)(" "+(0,o.v_)(e.$t("tickets.newTicket")),1)])]),Me.value?((0,i.uX)(),(0,i.CE)("div",K,[(0,i.bF)(m.A),(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.loadingTickets")),1)])):je.value.length>0?((0,i.uX)(),(0,i.CE)("div",F,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(je.value,function(t){return(0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"ticket-item",onClick:function(e){return ot(t)}},[(0,i.Lk)("div",x,[(0,i.Lk)("span",D,(0,o.v_)(t.subject),1),(0,i.Lk)("span",{class:(0,o.C4)(["ticket-status","status-".concat(t.status)])},(0,o.v_)(0===t.status?e.$t("tickets.statusOpen"):e.$t("tickets.statusClosed")),3)]),(0,i.Lk)("div",W,[(0,i.Lk)("span",z,(0,o.v_)((n=t.created_at,n?new Date(1e3*n).toLocaleString():"--")),1),(0,i.Lk)("span",M,"#"+(0,o.v_)(t.id),1)])],8,S);var n}),128))])):((0,i.uX)(),(0,i.CE)("div",j,[(0,i.bF)((0,c.R1)(f.yg_),{size:48}),(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.noTickets")),1),(0,i.Lk)("button",{class:"create-ticket-btn",onClick:lt},(0,o.v_)(e.$t("tickets.createNew")),1)]))]))],64)),((0,i.uX)(),(0,i.Wv)(i.Im,{to:"body"},[Ne.value?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"modal-overlay",onClick:rt},[(0,i.Lk)("div",{class:"modal-content",onClick:n[5]||(n[5]=(0,v.D$)(function(){},["stop"]))},[(0,i.Lk)("div",ve,[(0,i.Lk)("h3",null,(0,o.v_)(e.$t("tickets.createNew")),1),(0,i.Lk)("button",{class:"close-btn",onClick:rt},[(0,i.bF)((0,c.R1)(f.MRt),{size:20})])]),(0,i.Lk)("div",de,[(0,i.Lk)("div",pe,[(0,i.Lk)("label",null,(0,o.v_)(e.$t("tickets.subject")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=function(e){return Je.value.subject=e}),placeholder:e.$t("tickets.subjectPlaceholder")},null,8,ke),[[v.Jo,Je.value.subject]])]),(0,i.Lk)("div",fe,[(0,i.Lk)("label",null,(0,o.v_)(e.$t("tickets.level")),1),(0,i.Lk)("div",me,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)([0,1,2],function(e){return(0,i.Lk)("button",{key:e,class:(0,o.C4)(["priority-btn",{active:Je.value.level===e}]),onClick:function(t){return Je.value.level=e}},(0,o.v_)(at(e)),11,ge)}),64))])]),(0,i.Lk)("div",be,[(0,i.Lk)("label",null,(0,o.v_)(e.$t("tickets.message")),1),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":n[2]||(n[2]=function(e){return Je.value.message=e}),placeholder:e.$t("tickets.messagePlaceholder"),rows:"5"},null,8,ye),[[v.Jo,Je.value.message]]),(0,c.R1)(L.TICKET_CONFIG).isImageHosting?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,o.C4)(["image-upload-area",{dragging:Ct.value}]),onDragover:n[3]||(n[3]=(0,v.D$)(function(e){return Ct.value=!0},["prevent"])),onDragleave:n[4]||(n[4]=(0,v.D$)(function(e){return Ct.value=!1},["prevent"])),onDrop:(0,v.D$)($t,["prevent"]),onClick:Xt},[(0,i.Lk)("div",he,[(0,i.Lk)("span",Le,(0,o.v_)(e.$t("tickets.uploadTipText")||"\u62d6\u62fd\u56fe\u7247\u5230\u6b64\u5904\u6216\u70b9\u51fb\u4e0a\u4f20"),1),n[7]||(n[7]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("span",Ce,(0,o.v_)(e.$t("tickets.uploadDescText")||"\u652f\u6301 JPG\u3001PNG\u3001GIF \u683c\u5f0f\uff0c\u6700\u5927 5 MB"),1)]),(0,i.Lk)("input",{ref_key:"imageInput",ref:wt,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:Tt},null,544)],34)):(0,i.Q3)("",!0),Lt.value?((0,i.uX)(),(0,i.CE)("div",we,(0,o.v_)(e.$t("tickets.uploadingImages")||"\u56fe\u7247\u4e0a\u4f20\u4e2d..."),1)):(0,i.Q3)("",!0),ht.value.length?((0,i.uX)(),(0,i.CE)("div",_e,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ht.value,function(e){return(0,i.uX)(),(0,i.CE)("span",{key:e,class:"thumb",onClick:function(t){return function(e){var t="![image](".concat(e,")");(Je.value.message||"").includes(e)||Rt(t)}(e)},title:"\u70b9\u51fb\u63d2\u5165\u5230\u5185\u5bb9",style:{display:"inline-block","margin-right":"8px",cursor:"pointer"}},[(0,i.Lk)("img",{src:e,style:{"max-width":"60px","max-height":"60px","border-radius":"6px",border:"1px solid #eee"}},null,8,Re)],8,Ae)}),128))])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",Ee,[(0,i.Lk)("button",{class:"cancel-btn",onClick:rt},(0,o.v_)(e.$t("common.cancel")),1),(0,i.Lk)("button",{class:"submit-btn",onClick:gt,disabled:He.value},[He.value?((0,i.uX)(),(0,i.CE)("span",$e)):(0,i.Q3)("",!0),(0,i.eW)(" "+(0,o.v_)(e.$t("common.submit")),1)],8,Xe)])])])):(0,i.Q3)("",!0)])),Ve.value?((0,i.uX)(),(0,i.CE)("div",{key:2,class:"modal-overlay",onClick:ft},[(0,i.Lk)("div",{class:"modal-content",onClick:n[6]||(n[6]=(0,v.D$)(function(){},["stop"]))},[(0,i.Lk)("div",Te,[(0,i.Lk)("h3",null,(0,o.v_)(e.$t("tickets.closeConfirmTitle")),1),(0,i.Lk)("button",{class:"close-btn",onClick:ft},[(0,i.bF)((0,c.R1)(f.MRt),{size:20})])]),(0,i.Lk)("div",Ie,[(0,i.Lk)("p",null,(0,o.v_)(e.$t("tickets.closeConfirmText")),1)]),(0,i.Lk)("div",Ke,[(0,i.Lk)("button",{class:"cancel-btn",onClick:ft},(0,o.v_)(e.$t("common.cancel")),1),(0,i.Lk)("button",{class:"confirm-close-btn danger",onClick:mt,disabled:Ue.value},[Ue.value?((0,i.uX)(),(0,i.CE)("span",xe,[n[8]||(n[8]=(0,i.Lk)("span",{class:"spinner"},null,-1)),(0,i.eW)(" "+(0,o.v_)(e.$t("tickets.closing")),1)])):((0,i.uX)(),(0,i.CE)("span",Se,(0,o.v_)(e.$t("tickets.closeTicket")),1))],8,Fe)])])])):(0,i.Q3)("",!0),(0,i.bF)(C.A,{"show-popup":Ze.value,title:(0,c.R1)(et).title,content:(0,c.R1)(et).content,"cooldown-hours":(0,c.R1)(et).cooldownHours,"close-wait-seconds":(0,c.R1)(et).closeWaitSeconds,onClose:yt},null,8,["show-popup","title","content","cooldown-hours","close-wait-seconds"])])}}};const ze=(0,n(66262).A)(We,[["__scopeId","data-v-a0c59dde"]])},61701:(e,t,n)=>{var a=n(46518),s=n(69565),l=n(79306),r=n(28551),u=n(1767),i=n(19462),c=n(96319),o=n(9539),v=n(30684),d=n(84549),p=n(96395),k=!p&&!v("map",function(){}),f=!p&&!k&&d("map",TypeError),m=p||k||f,g=i(function(){var e=this.iterator,t=r(s(this.next,e));if(!(this.done=!!t.done))return c(e,this.mapper,[t.value,this.counter++],!0)});a({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(e){r(this);try{l(e)}catch(e){o(this,"throw",e)}return f?s(f,this,e):new g(u(this),{mapper:e})}})},62062:(e,t,n)=>{var a=n(46518),s=n(59213).map;a({target:"Array",proto:!0,forced:!n(70597)("map")},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},69668:(e,t,n)=>{n.d(t,{A:()=>f});var a=n(20641),s=n(53751),l=n(90033),r={key:0,class:"ticket-popup-container"},u={class:"ticket-popup-header"},i=["innerHTML"],c={class:"ticket-popup-content"},o=["innerHTML"],v={class:"ticket-popup-footer"},d=["disabled"];n(76918),n(59089),n(23288),n(2892),n(26099),n(38781),n(76031);var p=n(50953);const k={name:"TicketPopup",components:{IconX:n(25226).MRt},props:{showPopup:{type:Boolean,default:!1},title:{type:String,default:""},content:{type:String,default:""},cooldownHours:{type:Number,default:24},closeWaitSeconds:{type:Number,default:0}},emits:["close"],setup:function(e,t){var n=t.emit,s=(0,p.KR)(!1),l=(0,p.KR)(0),r=null;return(0,a.wB)(function(){return e.showPopup},function(t){t?setTimeout(function(){s.value=!0,r&&clearInterval(r),e.closeWaitSeconds>0?(l.value=e.closeWaitSeconds,r=setInterval(function(){l.value>0?l.value-=1:clearInterval(r)},1e3)):l.value=0},1e3):(s.value=!1,r&&clearInterval(r))},{immediate:!0}),(0,a.hi)(function(){r&&clearInterval(r)}),{show:s,attemptClose:function(){if(!(l.value>0)){if(s.value=!1,e.cooldownHours>0){var t=Date.now();localStorage.setItem("ticket_popup_close_time",t.toString())}n("close")}},waitTimeRemaining:l}}};const f=(0,n(66262).A)(k,[["render",function(e,t,n,p,k,f){var m=(0,a.g2)("IconX");return(0,a.uX)(),(0,a.Wv)(s.eB,{name:"fade"},{default:(0,a.k6)(function(){return[p.show?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"ticket-popup-overlay",onClick:t[2]||(t[2]=(0,s.D$)(function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)},["self"]))},[(0,a.bF)(s.eB,{name:"popup-slide"},{default:(0,a.k6)(function(){return[p.show?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",u,[(0,a.Lk)("h2",{class:"popup-title",innerHTML:n.title},null,8,i),(0,a.Lk)("button",{class:"popup-close-btn",onClick:t[0]||(t[0]=function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)})},[(0,a.bF)(m,{size:20})])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",{innerHTML:n.content},null,8,o)]),(0,a.Lk)("div",v,[(0,a.Lk)("button",{class:"popup-action-btn",onClick:t[1]||(t[1]=function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)}),disabled:p.waitTimeRemaining>0},[p.waitTimeRemaining>0?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,l.v_)(e.$t("tickets.popup.wait_close_btn",{seconds:p.waitTimeRemaining})),1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,l.v_)(e.$t("tickets.popup.close_btn")),1)],64))],8,d)])])):(0,a.Q3)("",!0)]}),_:1})])):(0,a.Q3)("",!0)]}),_:1})}],["__scopeId","data-v-053c6e2c"]])},90208:(e,t,n)=>{n.d(t,{A:()=>s});n(52675),n(89463),n(2259),n(16280),n(76918),n(26099),n(47764),n(62953);var a=n(54119);function s(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError((0,a.A)(e)+" is not iterable")}}}]);