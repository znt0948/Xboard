"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[494],{12321:(e,t,a)=>{a.d(t,{A:()=>u});var n=a(20641),s=a(90033),l={key:0,class:"spinner-text"};const i={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const u=(0,a(66262).A)(i,[["render",function(e,t,a,i,u,r){return(0,n.uX)(),(0,n.CE)("div",{class:(0,s.C4)(["loading-spinner",{"loading-spinner-overlay":a.overlay}])},[t[0]||(t[0]=(0,n.Lk)("div",{class:"spinner"},[(0,n.Lk)("div",{class:"spinner-circle"})],-1)),a.text?((0,n.uX)(),(0,n.CE)("div",l,(0,s.v_)(a.text),1)):(0,n.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])},46510:(e,t,a)=>{a.d(t,{F$:()=>s,Hi:()=>r,RV:()=>u,Z2:()=>l,yN:()=>i});var n=a(19043);function s(){return(0,n.A)({url:"/user/ticket/fetch",method:"get"})}function l(e){return(0,n.A)({url:"/user/ticket/save",method:"post",data:e})}function i(e){return(0,n.A)({url:"/user/ticket/fetch?id=".concat(e),method:"get"})}function u(e,t){return(0,n.A)({url:"/user/ticket/reply",method:"post",data:{id:e,message:t}})}function r(e){return(0,n.A)({url:"/user/ticket/close",method:"post",data:{id:e}})}},61701:(e,t,a)=>{var n=a(46518),s=a(69565),l=a(79306),i=a(28551),u=a(1767),r=a(19462),c=a(96319),o=a(9539),v=a(30684),d=a(84549),k=a(96395),p=!k&&!v("map",function(){}),m=!k&&!p&&d("map",TypeError),f=k||p||m,g=r(function(){var e=this.iterator,t=i(s(this.next,e));if(!(this.done=!!t.done))return c(e,this.mapper,[t.value,this.counter++],!0)});n({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(e){i(this);try{l(e)}catch(e){o(this,"throw",e)}return m?s(m,this,e):new g(u(this),{mapper:e})}})},62062:(e,t,a)=>{var n=a(46518),s=a(59213).map;n({target:"Array",proto:!0,forced:!a(70597)("map")},{map:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},69668:(e,t,a)=>{a.d(t,{A:()=>m});var n=a(20641),s=a(53751),l=a(90033),i={key:0,class:"ticket-popup-container"},u={class:"ticket-popup-header"},r=["innerHTML"],c={class:"ticket-popup-content"},o=["innerHTML"],v={class:"ticket-popup-footer"},d=["disabled"];a(76918),a(59089),a(23288),a(2892),a(26099),a(38781),a(76031);var k=a(50953);const p={name:"TicketPopup",components:{IconX:a(25226).MRt},props:{showPopup:{type:Boolean,default:!1},title:{type:String,default:""},content:{type:String,default:""},cooldownHours:{type:Number,default:24},closeWaitSeconds:{type:Number,default:0}},emits:["close"],setup:function(e,t){var a=t.emit,s=(0,k.KR)(!1),l=(0,k.KR)(0),i=null;return(0,n.wB)(function(){return e.showPopup},function(t){t?setTimeout(function(){s.value=!0,i&&clearInterval(i),e.closeWaitSeconds>0?(l.value=e.closeWaitSeconds,i=setInterval(function(){l.value>0?l.value-=1:clearInterval(i)},1e3)):l.value=0},1e3):(s.value=!1,i&&clearInterval(i))},{immediate:!0}),(0,n.hi)(function(){i&&clearInterval(i)}),{show:s,attemptClose:function(){if(!(l.value>0)){if(s.value=!1,e.cooldownHours>0){var t=Date.now();localStorage.setItem("ticket_popup_close_time",t.toString())}a("close")}},waitTimeRemaining:l}}};const m=(0,a(66262).A)(p,[["render",function(e,t,a,k,p,m){var f=(0,n.g2)("IconX");return(0,n.uX)(),(0,n.Wv)(s.eB,{name:"fade"},{default:(0,n.k6)(function(){return[k.show?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"ticket-popup-overlay",onClick:t[2]||(t[2]=(0,s.D$)(function(){return k.attemptClose&&k.attemptClose.apply(k,arguments)},["self"]))},[(0,n.bF)(s.eB,{name:"popup-slide"},{default:(0,n.k6)(function(){return[k.show?((0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("div",u,[(0,n.Lk)("h2",{class:"popup-title",innerHTML:a.title},null,8,r),(0,n.Lk)("button",{class:"popup-close-btn",onClick:t[0]||(t[0]=function(){return k.attemptClose&&k.attemptClose.apply(k,arguments)})},[(0,n.bF)(f,{size:20})])]),(0,n.Lk)("div",c,[(0,n.Lk)("div",{innerHTML:a.content},null,8,o)]),(0,n.Lk)("div",v,[(0,n.Lk)("button",{class:"popup-action-btn",onClick:t[1]||(t[1]=function(){return k.attemptClose&&k.attemptClose.apply(k,arguments)}),disabled:k.waitTimeRemaining>0},[k.waitTimeRemaining>0?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.eW)((0,l.v_)(e.$t("tickets.popup.wait_close_btn",{seconds:k.waitTimeRemaining})),1)],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,l.v_)(e.$t("tickets.popup.close_btn")),1)],64))],8,d)])])):(0,n.Q3)("",!0)]}),_:1})])):(0,n.Q3)("",!0)]}),_:1})}],["__scopeId","data-v-053c6e2c"]])},83494:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ge});var n=a(41034),s=a(78676),l=a(90208),i=a(20908),u=a(30388),r=(a(16280),a(76918),a(28706),a(2008),a(23418),a(74423),a(64346),a(62062),a(44114),a(34782),a(59089),a(23288),a(18111),a(22489),a(61701),a(2892),a(26099),a(58940),a(99449),a(21699),a(47764),a(11392),a(42762),a(62953),a(76031),a(20641)),c=a(50953),o=a(90033),v=a(53751),d=a(46992),k=a(75220),p=a(33263),m=a(25226),f=a(46510),g=a(92549),h=a(49586),b=a(12321),y=a(33366),L=a(69668),C=a(80394),w={class:"ticket-container"},_={key:0,class:"screen-size-notice"},R={class:"notice-content"},A={class:"dashboard-card welcome-card"},E={class:"card-header"},X={class:"card-title"},$={class:"card-body"},T={class:"ticket-list-container"},K={class:"ticket-sidebar"},I={class:"ticket-header"},F={class:"search-box"},x=["placeholder"],S={key:0,class:"ticket-list"},W=["onClick"],z={class:"ticket-info"},D={class:"ticket-subject"},M={class:"ticket-meta"},j={class:"ticket-time"},Q={class:"ticket-status"},H={key:1,class:"ticket-loading"},N={key:2,class:"empty-state"},P={class:"ticket-content"},B={class:"ticket-detail-header"},G={class:"ticket-subject-info"},O={class:"ticket-detail-meta"},V={class:"ticket-time"},U={class:"ticket-actions"},Y=["disabled"],J={key:0},q={key:1,class:"loading-text"},Z={class:"ticket-detail-content"},ee={class:"ticket-messages"},te={key:0,class:"message-loading"},ae={key:1,class:"no-messages"},ne={key:0,class:"message-avatar admin-avatar"},se={class:"message-content"},le={class:"message-header"},ie={key:0,class:"message-sender"},ue=["innerHTML"],re={key:1,class:"message-avatar user-avatar"},ce={class:"message-time-floating"},oe={key:0,class:"reply-container"},ve=["placeholder","onKeydown"],de={class:"reply-tools",style:{display:"flex",gap:"8px","align-items":"center"}},ke=["disabled"],pe={key:1,class:"loader"},me={key:2},fe={key:3},ge=["disabled"],he={key:0,class:"loader"},be={key:1,class:"ticket-closed-notice"},ye={key:1,class:"no-selection"},Le={class:"modal-header"},Ce={class:"modal-body"},we={class:"form-group"},_e=["placeholder"],Re={class:"form-group"},Ae={class:"level-tags"},Ee={class:"form-group"},Xe=["placeholder"],$e={class:"upload-tip"},Te={class:"upload-tip-text"},Ke={class:"upload-desc"},Ie={key:1,style:{"margin-top":"8px",color:"#2196f3"}},Fe={key:2,style:{"margin-top":"8px"}},xe=["onClick"],Se=["src"],We={class:"modal-footer"},ze=["disabled"],De={key:0,class:"loader"},Me={class:"modal-header"},je={class:"modal-body"},Qe={class:"modal-footer"},He=["disabled"],Ne={key:0,class:"loader"},Pe="https://api.imgbb.com/1/upload";const Be={__name:"TicketList",setup:function(e){var t=new p.A({linkify:!0,breaks:!0}),a=(0,d.s9)().t,Be=(0,y.d)().showToast,Ge=(0,c.KR)([]),Oe=(0,c.KR)(null),Ve=(0,c.KR)(""),Ue=(0,c.KR)(!1),Ye=(0,c.KR)(!1),Je=(0,c.KR)([]),qe=(0,c.KR)(!1),Ze=(0,c.KR)(""),et=(0,c.KR)(!1),tt=(0,c.KR)(!1),at=(0,c.KR)(!1),nt=(0,c.KR)(!1),st=(0,c.KR)(null),lt=(0,c.KR)([]),it=(0,c.KR)(!1),ut=(0,c.KR)(!1),rt=(0,c.KR)(null),ct=(0,c.KR)(null),ot=(0,c.KR)(0),vt=function(){var e,t=ct.value;t&&(ot.value=null!==(e=t.selectionStart)&&void 0!==e?e:Xt.value.message.length)},dt=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var a,n,s,l,u,c,o,v;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if(l=ct.value,u=Xt.value.message||"",l){e.n=1;break}return Xt.value.message=u+(u&&!u.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return c=null!==(a=null!==(n=l.selectionStart)&&void 0!==n?n:ot.value)&&void 0!==a?a:u.length,o=null!==(s=l.selectionEnd)&&void 0!==s?s:c,Xt.value.message=u.slice(0,c)+t+u.slice(o),e.n=2,(0,r.dY)();case 2:v=c+t.length,l.focus(),l.setSelectionRange(v,v),ot.value=v;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),kt=C.TICKET_CONFIG.imgbbApiKey,pt=function(){rt.value&&rt.value.click()},mt=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var a;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if(ut.value=!1,!(a=Array.from(t.dataTransfer.files).filter(function(e){return e.type.startsWith("image/")})).length){e.n=1;break}return e.n=1,ft({target:{files:a}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var a,n,s,u;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if((a=Array.from(t.target.files)).length){e.n=1;break}return e.a(2);case 1:it.value=!0,n=(0,i.A)().m(function e(){var t,a,n,l,r,c;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!((t=u[s]).size>5242880)){e.n=1;break}return Be("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(2,1);case 1:return e.p=1,e.n=2,new Promise(function(e,a){var n=new FileReader;n.onload=function(){return e(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(t)});case 2:return a=e.v,(n=new FormData).append("image",a),e.n=3,fetch("".concat(Pe,"?key=").concat(kt),{method:"POST",body:n});case 3:return l=e.v,e.n=4,l.json();case 4:(r=e.v).success&&r.data&&r.data.url?(lt.value.push(r.data.url),Xt.value.message+="\n![image](".concat(r.data.url,")")):Be((null===(c=r.error)||void 0===c?void 0:c.message)||"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25","error"),e.n=6;break;case 5:e.p=5,e.v,Be("\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 6:return e.a(2)}},e,null,[[1,5]])}),s=0,u=a;case 2:if(!(s<u.length)){e.n=5;break}return e.d((0,l.A)(n()),3);case 3:if(!e.v){e.n=4;break}return e.a(3,4);case 4:s++,e.n=2;break;case 5:it.value=!1;case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),gt=(0,c.KR)(null),ht=(0,c.KR)(null),bt=(0,c.KR)(!1),yt=(0,c.KR)(0),Lt=function(){gt.value&&gt.value.click()},Ct=function(){var e,t=ht.value;t&&(yt.value=null!==(e=t.selectionStart)&&void 0!==e?e:Ze.value.length)},wt=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var a,n,s,l,u,c,o,v;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if(l=ht.value,u=Ze.value||"",l){e.n=1;break}return Ze.value=u+(u&&!u.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return c=null!==(a=null!==(n=l.selectionStart)&&void 0!==n?n:yt.value)&&void 0!==a?a:u.length,o=null!==(s=l.selectionEnd)&&void 0!==s?s:c,Ze.value=u.slice(0,c)+t+u.slice(o),e.n=2,(0,r.dY)();case 2:v=c+t.length,l.focus(),l.setSelectionRange(v,v),yt.value=v;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),_t=function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=function(){return t(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(e)})},Rt=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var a,n,s,l,u,r;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,_t(t);case 1:return s=e.v,(l=new FormData).append("image",s),e.n=2,fetch("".concat(Pe,"?key=").concat(kt),{method:"POST",body:l});case 2:return u=e.v,e.n=3,u.json();case 3:if(!(r=e.v).success||null===(a=r.data)||void 0===a||!a.url){e.n=4;break}return e.a(2,r.data.url);case 4:throw new Error((null===(n=r.error)||void 0===n?void 0:n.message)||"imgbb \u4e0a\u4f20\u5931\u8d25");case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),At=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var a,n,s,l,u,r,c,o;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if((a=Array.from(t.target.files||[])).length){e.n=1;break}return e.a(2);case 1:bt.value=!0,e.p=2,s=0,l=a;case 3:if(!(s<l.length)){e.n=7;break}if(!((u=l[s]).size>5242880)){e.n=4;break}return Be("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(3,6);case 4:return e.n=5,Rt(u);case 5:return r=e.v,c="![image](".concat(r,")"),e.n=6,wt(c);case 6:s++,e.n=3;break;case 7:Be((null===(n=$t)||void 0===n?void 0:n("tickets.uploadSuccess"))||"\u56fe\u7247\u4e0a\u4f20\u6210\u529f","success"),e.n=9;break;case 8:e.p=8,o=e.v,Be(o.message||"\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 9:return e.p=9,bt.value=!1,gt.value&&(gt.value.value=""),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(t){return e.apply(this,arguments)}}(),Et=(0,c.KR)({subject:"",message:""}),Xt=(0,c.KR)({subject:"",message:"",level:"0"}),Tt=(0,r.EW)(function(){if(!Ve.value)return Ge.value;var e=Ve.value.toLowerCase();return Ge.value.filter(function(t){return t.subject.toLowerCase().includes(e)})}),Kt=function(){var e=(0,u.A)((0,i.A)().m(function e(){var t,n,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return nt.value=!0,e.p=1,e.n=2,(0,f.F$)();case 2:t=e.v,Ge.value=Array.isArray(t.data)?t.data:[],e.n=4;break;case 3:e.p=3,s=e.v,Be((null===(n=s.response)||void 0===n?void 0:n.message)||s.message||a("tickets.fetchError"),"error"),Ge.value=[];case 4:return e.p=4,nt.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),It=function(){var e=(0,u.A)((0,i.A)().m(function e(){var t,n,l,u,r,c,o,v,d,k,p,m;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Xt.value.subject.trim()){e.n=1;break}return Et.value.subject=a("tickets.subjectRequired"),e.a(2);case 1:Et.value.subject="";case 2:if(Xt.value.message.trim()){e.n=3;break}return Et.value.message=a("tickets.messageRequired"),e.a(2);case 3:Et.value.message="";case 4:return Ye.value=!0,e.p=5,e.n=6,Promise.all([(0,g.ug)(),(0,g.l8)(),(0,g._8)(),(0,g.XL)()]);case 6:return t=e.v,n=(0,s.A)(t,4),l=n[0],u=n[1],r=n[2],c=n[3],u&&u.data&&u.data.currency_symbol&&(l.currency_symbol=u.data.currency_symbol),o=(0,h.AB)(l,c,r),v="".concat(Xt.value.message,"\n\n").concat(o),e.n=7,(0,f.Z2)({subject:Xt.value.subject,message:v,level:parseInt(Xt.value.level)});case 7:if(!(d=e.v).data){e.n=9;break}return Be(d.message||a("tickets.createSuccess"),"success"),Gt(),e.n=8,Kt();case 8:Ge.value.length>0&&(k=Ge.value[0],Nt(k));case 9:e.n=11;break;case 10:e.p=10,m=e.v,Be((null===(p=m.response)||void 0===p?void 0:p.message)||m.message||a("tickets.createError"),"error");case 11:return e.p=11,Ye.value=!1,e.f(11);case 12:return e.a(2)}},e,null,[[5,10,11,12]])}));return function(){return e.apply(this,arguments)}}(),Ft=function(){var e=(0,u.A)((0,i.A)().m(function e(t){var s,l,u,r,c=arguments;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return(s=c.length>1&&void 0!==c[1]&&c[1])||(qe.value=!0,Je.value=[]),e.p=1,e.n=2,(0,f.yN)(t);case 2:(l=e.v).data&&(l.data.message&&Array.isArray(l.data.message)?Je.value=l.data.message.map(function(e){return(0,n.A)((0,n.A)({},e),{},{is_admin:!e.is_me})}):Je.value=[],Oe.value&&Oe.value.id===t&&void 0!==l.data.status&&(Oe.value.status=l.data.status,1===l.data.status&&xt())),e.n=4;break;case 3:e.p=3,r=e.v,Be((null===(u=r.response)||void 0===u?void 0:u.message)||r.message||a("tickets.fetchDetailError"),"error");case 4:return e.p=4,s||(qe.value=!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),xt=function(){st.value&&(clearInterval(st.value),st.value=null)},St=function(){var e=(0,u.A)((0,i.A)().m(function e(){var t,n,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Ze.value.trim()&&Oe.value){e.n=1;break}return e.a(2);case 1:return et.value=!0,e.p=2,e.n=3,(0,f.RV)(Oe.value.id,Ze.value);case 3:if(!(t=e.v).data){e.n=4;break}return Be(t.message||a("tickets.replySent"),"success"),Ze.value="",e.n=4,Ft(Oe.value.id,!0);case 4:e.n=6;break;case 5:e.p=5,s=e.v,Be((null===(n=s.response)||void 0===n?void 0:n.message)||s.message||a("tickets.replyError"),"error");case 6:return e.p=6,et.value=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),Wt=function(){var e=(0,u.A)((0,i.A)().m(function e(){var t,n,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Oe.value){e.n=1;break}return e.a(2);case 1:return at.value=!0,e.p=2,e.n=3,(0,f.Hi)(Oe.value.id);case 3:if(!0!==(t=e.v).data){e.n=6;break}return Be(t.message||a("tickets.closeSuccess"),"success"),Oe.value.status=1,xt(),e.n=4,Ft(Oe.value.id);case 4:return e.n=5,Kt();case 5:Pt.value=!0,Bt.value=!1,setTimeout(function(){tt.value=!1,Pt.value=!1},250);case 6:e.n=8;break;case 7:e.p=7,s=e.v,Be((null===(n=s.response)||void 0===n?void 0:n.message)||s.message||a("tickets.closeError"),"error");case 8:return e.p=8,at.value=!1,e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(){return e.apply(this,arguments)}}(),zt=function(e){return e?new Date(1e3*e).toLocaleString():"--"},Dt=function(e){return a(0===e?"tickets.statusOpen":"tickets.statusClosed")},Mt=function(e){return 0===e?"status-open":"status-closed"},jt=function(e){var t={0:a("tickets.levelLow"),1:a("tickets.levelMedium"),2:a("tickets.levelHigh")};return t[e]||t[0]},Qt=function(e){var t={0:"level-low",1:"level-medium",2:"level-high"};return t[e]||t[0]},Ht=function(){},Nt=function(e){var t;xt(),Oe.value=e,Ft(e.id),0===e.status&&(t=e.id,xt(),Oe.value&&0===Oe.value.status&&(st.value=setInterval(function(){Oe.value&&Oe.value.id===t?Ft(t,!0):xt()},5e3)))},Pt=(0,c.KR)(!1),Bt=(0,c.KR)(!1),Gt=function(){Pt.value=!0,Bt.value=!1,setTimeout(function(){Ue.value=!1,Pt.value=!1,Xt.value={subject:"",message:"",level:"0"}},250)},Ot=function(){Pt.value=!1,Ue.value=!0,setTimeout(function(){Bt.value=!0},10)},Vt=function(){tt.value?(Pt.value=!0,Bt.value=!1,setTimeout(function(){tt.value=!1,Pt.value=!1},250)):(Pt.value=!1,tt.value=!0,setTimeout(function(){Bt.value=!0},10))},Ut=function(e,t){return 0===e||Je.value[e-1].is_admin!==t},Yt=function(e){if(!e)return"--";var t=new Date(1e3*e),a=new Date;return t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.getDate()+"\u65e5 "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},Jt=(0,c.KR)(!1),qt=(0,k.rd)(),Zt=function(){Jt.value=window.innerWidth<905},ea=function(){qt.push("/mobile/tickets")},ta=(0,c.KR)(!1),aa=(null===C.TICKET_CONFIG||void 0===C.TICKET_CONFIG?void 0:C.TICKET_CONFIG.popup)||{},na=function(){ta.value=!1};return(0,r.sV)(function(){Zt(),window.addEventListener("resize",Zt),Kt(),function(){if(aa.enabled){var e=Number(localStorage.getItem("ticket_popup_close_time")||0),t=3600*(aa.cooldownHours||0)*1e3;(!e||Date.now()-e>=t)&&(ta.value=!0)}}()}),(0,r.hi)(function(){window.removeEventListener("resize",Zt),xt()}),function(e,a){return(0,r.uX)(),(0,r.CE)("div",w,[Jt.value?((0,r.uX)(),(0,r.CE)("div",_,[(0,r.Lk)("div",R,[(0,r.bF)((0,c.R1)(m.q2Q),{size:48}),(0,r.Lk)("h2",null,(0,o.v_)(e.$t("tickets.smallScreenNotice")),1),(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.switchToMobile")),1),(0,r.Lk)("button",{class:"switch-btn",onClick:ea},(0,o.v_)(e.$t("tickets.switchToMobileView")),1)])])):((0,r.uX)(),(0,r.CE)(r.FK,{key:1},[(0,r.Lk)("div",A,[(0,r.Lk)("div",E,[(0,r.Lk)("h2",X,(0,o.v_)(e.$t("tickets.title")),1)]),(0,r.Lk)("div",$,[(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.description")),1)])]),(0,r.Lk)("div",T,[(0,r.Lk)("div",K,[(0,r.Lk)("div",I,[(0,r.Lk)("div",F,[(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=function(e){return Ve.value=e}),placeholder:e.$t("tickets.searchPlaceholder"),onInput:Ht},null,40,x),[[v.Jo,Ve.value]]),(0,r.bF)((0,c.R1)(m.C0l),{size:16,class:"search-icon"})]),(0,r.Lk)("button",{class:"new-ticket-btn",onClick:Ot},[(0,r.bF)((0,c.R1)(m.uID),{size:16}),(0,r.eW)(" "+(0,o.v_)(e.$t("tickets.newTicket")),1)])]),Ge.value.length>0&&!nt.value?((0,r.uX)(),(0,r.CE)("div",S,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Tt.value,function(e){var t;return(0,r.uX)(),(0,r.CE)("div",{key:e.id,class:(0,o.C4)(["ticket-item",{active:(null===(t=Oe.value)||void 0===t?void 0:t.id)===e.id}]),onClick:function(t){return Nt(e)}},[(0,r.Lk)("div",z,[(0,r.Lk)("h3",D,(0,o.v_)(e.subject),1),(0,r.Lk)("div",M,[(0,r.Lk)("span",j,(0,o.v_)(zt(e.updated_at)),1),(0,r.Lk)("div",Q,[(0,r.Lk)("span",{class:(0,o.C4)(["status-badge",Mt(e.status)])},(0,o.v_)(Dt(e.status)),3),(0,r.Lk)("span",{class:(0,o.C4)(["level-badge",Qt(e.level)])},(0,o.v_)(jt(e.level)),3)])])])],10,W)}),128))])):nt.value?((0,r.uX)(),(0,r.CE)("div",H,[(0,r.bF)(b.A),(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.loadingTickets")),1)])):((0,r.uX)(),(0,r.CE)("div",N,[(0,r.bF)((0,c.R1)(m.yg_),{size:48,class:"empty-icon"}),(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.noTickets")),1)]))]),(0,r.Lk)("div",P,[Oe.value?((0,r.uX)(),(0,r.CE)(r.FK,{key:0},[(0,r.Lk)("div",B,[(0,r.Lk)("div",G,[(0,r.Lk)("h2",null,(0,o.v_)(Oe.value.subject),1),(0,r.Lk)("div",O,[(0,r.Lk)("span",{class:(0,o.C4)(["status-badge",Mt(Oe.value.status)])},(0,o.v_)(Dt(Oe.value.status)),3),(0,r.Lk)("span",{class:(0,o.C4)(["level-badge",Qt(Oe.value.level)])},(0,o.v_)(jt(Oe.value.level)),3),(0,r.Lk)("span",V,(0,o.v_)(e.$t("tickets.createdAt"))+": "+(0,o.v_)(zt(Oe.value.created_at)),1)])]),(0,r.Lk)("div",U,[0===Oe.value.status?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"close-ticket-btn",onClick:a[1]||(a[1]=function(e){return Vt()}),disabled:at.value},[at.value?((0,r.uX)(),(0,r.CE)("span",q,[a[14]||(a[14]=(0,r.Lk)("span",{class:"loading-spinner"},null,-1)),(0,r.eW)(" "+(0,o.v_)(e.$t("tickets.closing")),1)])):((0,r.uX)(),(0,r.CE)("span",J,(0,o.v_)(e.$t("tickets.closeTicket")),1))],8,Y)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",Z,[(0,r.Lk)("div",ee,[qe.value?((0,r.uX)(),(0,r.CE)("div",te,[(0,r.bF)(b.A),(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.loadingMessages")),1)])):0===Je.value.length?((0,r.uX)(),(0,r.CE)("div",ae,[(0,r.bF)((0,c.R1)(m.bYO),{size:64,class:"no-messages-icon"}),(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.noMessages")),1)])):((0,r.uX)(!0),(0,r.CE)(r.FK,{key:2},(0,r.pI)(Je.value,function(a,n){return(0,r.uX)(),(0,r.CE)("div",{key:a.id,class:(0,o.C4)(["message-item",{"admin-message":a.is_admin,"user-message":!a.is_admin}])},[a.is_admin?((0,r.uX)(),(0,r.CE)("div",ne,[(0,r.bF)((0,c.R1)(m.ut_))])):(0,r.Q3)("",!0),(0,r.Lk)("div",se,[(0,r.Lk)("div",le,[Ut(n,a.is_admin)?((0,r.uX)(),(0,r.CE)("span",ie,(0,o.v_)(a.is_admin?e.$t("tickets.admin"):e.$t("tickets.you")),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("div",{class:"message-text",innerHTML:(0,c.R1)(t).render(a.message)},null,8,ue)]),a.is_admin?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",re,[(0,r.bF)((0,c.R1)(m.vg7))])),(0,r.Lk)("span",ce,(0,o.v_)(Yt(a.created_at)),1)],2)}),128))])]),0===Oe.value.status?((0,r.uX)(),(0,r.CE)("div",oe,[(0,r.bo)((0,r.Lk)("textarea",{ref_key:"replyTextarea",ref:ht,"onUpdate:modelValue":a[2]||(a[2]=function(e){return Ze.value=e}),placeholder:e.$t("tickets.replyPlaceholder"),rows:"3",onKeydown:(0,v.jR)((0,v.D$)(St,["ctrl"]),["enter"]),onKeyup:Ct,onClick:Ct},null,40,ve),[[v.Jo,Ze.value]]),(0,r.Lk)("div",de,[(0,r.Lk)("button",{class:"send-reply-btn",type:"button",onClick:Lt,disabled:bt.value},[bt.value?((0,r.uX)(),(0,r.CE)("span",pe)):((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.GYm),{key:0,size:18})),bt.value?((0,r.uX)(),(0,r.CE)("span",fe,(0,o.v_)(e.$t("tickets.uploadingImages")||"\u4e0a\u4f20\u4e2d"),1)):((0,r.uX)(),(0,r.CE)("span",me,(0,o.v_)(e.$t("tickets.upPictures")||"\u4e0a\u4f20\u56fe\u7247"),1))],8,ke),(0,r.Lk)("button",{class:"send-reply-btn",onClick:St,disabled:!Ze.value.trim()||et.value},[et.value?((0,r.uX)(),(0,r.CE)("span",he)):((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.mDt),{key:1,size:18})),(0,r.eW)(" "+(0,o.v_)(e.$t("tickets.send")),1)],8,ge)]),(0,r.Lk)("input",{ref_key:"replyImageInput",ref:gt,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:At},null,544)])):((0,r.uX)(),(0,r.CE)("div",be,[(0,r.bF)((0,c.R1)(m.XEb),{size:20}),(0,r.Lk)("span",null,(0,o.v_)(e.$t("tickets.ticketClosed")),1)]))],64)):((0,r.uX)(),(0,r.CE)("div",ye,[(0,r.bF)((0,c.R1)(m.pjm),{size:64,class:"no-selection-icon"}),(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.selectTicket")),1)]))])]),((0,r.uX)(),(0,r.Wv)(r.Im,{to:"body"},[Ue.value?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,o.C4)(["modal-overlay",{"show-overlay":Bt.value}]),onClick:Gt},[(0,r.Lk)("div",{class:(0,o.C4)(["modal-content",{"modal-close-animation":Pt.value}]),onClick:a[10]||(a[10]=(0,v.D$)(function(){},["stop"]))},[(0,r.Lk)("div",Le,[(0,r.Lk)("h3",null,(0,o.v_)(e.$t("tickets.createNew")),1),(0,r.Lk)("button",{class:"modal-close",onClick:Gt},[(0,r.bF)((0,c.R1)(m.MRt),{size:20})])]),(0,r.Lk)("div",Ce,[(0,r.Lk)("div",we,[(0,r.Lk)("label",null,(0,o.v_)(e.$t("tickets.subject")),1),(0,r.bo)((0,r.Lk)("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=function(e){return Xt.value.subject=e}),placeholder:e.$t("tickets.subjectPlaceholder")},null,8,_e),[[v.Jo,Xt.value.subject]])]),(0,r.Lk)("div",Re,[(0,r.Lk)("label",null,(0,o.v_)(e.$t("tickets.level")),1),(0,r.Lk)("div",Ae,[(0,r.Lk)("div",{class:(0,o.C4)(["level-tag",{active:"0"===Xt.value.level,"level-low":!0}]),onClick:a[4]||(a[4]=function(e){return Xt.value.level="0"})},["0"===Xt.value.level?((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.iQ6),{key:0,size:16,class:"tag-icon"})):((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.ABt),{key:1,size:16,class:"tag-icon"})),(0,r.eW)(" "+(0,o.v_)(e.$t("tickets.levelLow")),1)],2),(0,r.Lk)("div",{class:(0,o.C4)(["level-tag",{active:"1"===Xt.value.level,"level-medium":!0}]),onClick:a[5]||(a[5]=function(e){return Xt.value.level="1"})},["1"===Xt.value.level?((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.iQ6),{key:0,size:16,class:"tag-icon"})):((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.ABt),{key:1,size:16,class:"tag-icon"})),(0,r.eW)(" "+(0,o.v_)(e.$t("tickets.levelMedium")),1)],2),(0,r.Lk)("div",{class:(0,o.C4)(["level-tag",{active:"2"===Xt.value.level,"level-high":!0}]),onClick:a[6]||(a[6]=function(e){return Xt.value.level="2"})},["2"===Xt.value.level?((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.iQ6),{key:0,size:16,class:"tag-icon"})):((0,r.uX)(),(0,r.Wv)((0,c.R1)(m.ABt),{key:1,size:16,class:"tag-icon"})),(0,r.eW)(" "+(0,o.v_)(e.$t("tickets.levelHigh")),1)],2)])]),(0,r.Lk)("div",Ee,[(0,r.Lk)("label",null,(0,o.v_)(e.$t("tickets.message")),1),(0,r.bo)((0,r.Lk)("textarea",{ref_key:"newTicketTextarea",ref:ct,"onUpdate:modelValue":a[7]||(a[7]=function(e){return Xt.value.message=e}),placeholder:e.$t("tickets.messagePlaceholder"),rows:"5",onKeyup:vt,onClick:vt},null,40,Xe),[[v.Jo,Xt.value.message]]),(0,c.R1)(C.TICKET_CONFIG).isImageHosting?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,o.C4)(["image-upload-area",{dragging:ut.value}]),onDragover:a[8]||(a[8]=(0,v.D$)(function(e){return ut.value=!0},["prevent"])),onDragleave:a[9]||(a[9]=(0,v.D$)(function(e){return ut.value=!1},["prevent"])),onDrop:(0,v.D$)(mt,["prevent"]),onClick:pt},[a[16]||(a[16]=(0,r.Lk)("div",{class:"upload-icon"},[(0,r.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon icon-tabler icons-tabler-outline icon-tabler-cloud-up"},[(0,r.Lk)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,r.Lk)("path",{d:"M12 18.004h-5.343c-2.572 -.004 -4.657 -2.011 -4.657 -4.487c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.38 0 2.57 .811 3.128 1.986"}),(0,r.Lk)("path",{d:"M19 22v-6"}),(0,r.Lk)("path",{d:"M22 19l-3 -3l-3 3"})])],-1)),(0,r.Lk)("div",$e,[(0,r.Lk)("span",Te,(0,o.v_)(e.$t("tickets.uploadTipText")||"\u62d6\u62fd\u56fe\u7247\u5230\u6b64\u5904\u6216\u70b9\u51fb\u4e0a\u4f20"),1),a[15]||(a[15]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("span",Ke,(0,o.v_)(e.$t("tickets.uploadDescText")||"\u652f\u6301 JPG\u3001PNG\u3001GIF \u683c\u5f0f\uff0c\u6700\u5927 5 MB"),1)]),(0,r.Lk)("input",{ref_key:"imageInput",ref:rt,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:ft},null,544)],34)):(0,r.Q3)("",!0),it.value?((0,r.uX)(),(0,r.CE)("div",Ie,(0,o.v_)(e.$t("tickets.uploadingImages")||"\u56fe\u7247\u4e0a\u4f20\u4e2d..."),1)):(0,r.Q3)("",!0),lt.value.length?((0,r.uX)(),(0,r.CE)("div",Fe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(lt.value,function(e){return(0,r.uX)(),(0,r.CE)("span",{key:e,class:"thumb",onClick:function(t){return function(e){var t="![image](".concat(e,")");(Xt.value.message||"").includes(e)||dt(t)}(e)},title:"\u70b9\u51fb\u63d2\u5165\u5230\u5185\u5bb9",style:{display:"inline-block","margin-right":"8px",cursor:"pointer"}},[(0,r.Lk)("img",{src:e,style:{"max-width":"60px","max-height":"60px","border-radius":"6px",border:"1px solid #eee"}},null,8,Se)],8,xe)}),128))])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",We,[(0,r.Lk)("button",{class:"btn-cancel",onClick:Gt},(0,o.v_)(e.$t("common.cancel")),1),(0,r.Lk)("button",{class:"btn-submit",onClick:It,disabled:Ye.value,type:"button"},[Ye.value?((0,r.uX)(),(0,r.CE)("span",De)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,o.v_)(e.$t("common.submit")),1)],8,ze)])],2)],2)):(0,r.Q3)("",!0)])),tt.value?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,o.C4)(["modal-overlay",{"show-overlay":Bt.value}]),onClick:Vt},[(0,r.Lk)("div",{class:(0,o.C4)(["modal-content",{"modal-close-animation":Pt.value}]),onClick:a[13]||(a[13]=(0,v.D$)(function(){},["stop"]))},[(0,r.Lk)("div",Me,[(0,r.Lk)("h3",null,(0,o.v_)(e.$t("tickets.closeConfirmTitle")),1),(0,r.Lk)("button",{class:"modal-close",onClick:a[11]||(a[11]=function(e){return tt.value=!1})},[(0,r.bF)((0,c.R1)(m.MRt),{size:20})])]),(0,r.Lk)("div",je,[(0,r.Lk)("p",null,(0,o.v_)(e.$t("tickets.closeConfirmText")),1)]),(0,r.Lk)("div",Qe,[(0,r.Lk)("button",{class:"btn-cancel",onClick:a[12]||(a[12]=function(e){return tt.value=!1})},(0,o.v_)(e.$t("common.cancel")),1),(0,r.Lk)("button",{class:"btn-submit",onClick:Wt,disabled:at.value},[at.value?((0,r.uX)(),(0,r.CE)("span",Ne)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,o.v_)(e.$t("common.confirm")),1)],8,He)])],2)],2)):(0,r.Q3)("",!0)],64)),(0,r.bF)(L.A,{"show-popup":ta.value,title:(0,c.R1)(aa).title,content:(0,c.R1)(aa).content,"cooldown-hours":(0,c.R1)(aa).cooldownHours,"close-wait-seconds":(0,c.R1)(aa).closeWaitSeconds,onClose:na},null,8,["show-popup","title","content","cooldown-hours","close-wait-seconds"])])}}};const Ge=(0,a(66262).A)(Be,[["__scopeId","data-v-85f17e4c"]])},90208:(e,t,a)=>{a.d(t,{A:()=>s});a(52675),a(89463),a(2259),a(16280),a(76918),a(26099),a(47764),a(62953);var n=a(54119);function s(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],a=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}throw new TypeError((0,n.A)(e)+" is not iterable")}}}]);