"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[69],{12321:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(20641),r=n(90033),o={key:0,class:"spinner-text"};const s={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const l=(0,n(66262).A)(s,[["render",function(e,t,n,s,l,u){return(0,a.uX)(),(0,a.CE)("div",{class:(0,r.C4)(["loading-spinner",{"loading-spinner-overlay":n.overlay}])},[t[0]||(t[0]=(0,a.Lk)("div",{class:"spinner"},[(0,a.Lk)("div",{class:"spinner-circle"})],-1)),n.text?((0,a.uX)(),(0,a.CE)("div",o,(0,r.v_)(n.text),1)):(0,a.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])},43258:(e,t,n)=>{n.d(t,{J5:()=>i,Jf:()=>d,KU:()=>c,N4:()=>v,Z7:()=>u,hh:()=>p,l8:()=>o,n$:()=>r,oX:()=>s,sm:()=>l});var a=n(19043);function r(){return(0,a.A)({url:"/user/plan/fetch",method:"get"})}function o(){return(0,a.A)({url:"/user/comm/config",method:"get"})}function s(e){return(0,a.A)({url:"/user/plan/fetch?id=".concat(e),method:"get"})}function l(e,t){return(0,a.A)({url:"/user/coupon/check",method:"post",data:{code:e,plan_id:t}})}function u(e){return(0,a.A)({url:"/user/order/save",method:"post",data:e})}function c(e){return(0,a.A)({url:"/user/order/detail?trade_no=".concat(e),method:"get"})}function i(){return(0,a.A)({url:"/user/order/getPaymentMethod",method:"get"})}function d(e){return(0,a.A)({url:"/user/order/check?trade_no=".concat(e),method:"get"})}function v(e){return(0,a.A)({url:"/user/order/cancel",method:"post",data:{trade_no:e}})}function p(e,t){return(0,a.A)({url:"/user/order/checkout",method:"post",data:{trade_no:e,method:t}})}},98069:(e,t,n)=>{n.r(t),n.d(t,{default:()=>be});var a=n(59258),r=n(20908),o=n(30388),s=(n(16280),n(76918),n(28706),n(44114),n(34782),n(23288),n(9868),n(20641)),l=n(90033),u=n(50953),c=n(53751),i=n(46992),d=n(75220),v=n(12321),p=n(25226),k=n(54119),f=(n(26099),n(19043));function h(){return(0,f.A)({url:"/user/order/fetch",method:"get"}).then(function(e){if("object"===(0,k.A)(e))return e;throw new Error("Invalid response format")}).catch(function(e){throw e})}function _(e){return new Promise(function(t,n){e?(0,f.A)({url:"/user/order/cancel",method:"post",data:{trade_no:e}}).then(function(e){e&&"object"===(0,k.A)(e)?t(e):n(new Error("\u8fd4\u56de\u6570\u636e\u683c\u5f0f\u4e0d\u6b63\u786e"))}).catch(function(e){var t="\u53d6\u6d88\u8ba2\u5355\u5931\u8d25";if(e)if("string"==typeof e.message)t=e.message;else if(e.response&&e.response.data){var a=e.response.data;"string"==typeof a?t=a:a.message?t=a.message:a.error&&(t=a.error)}n(new Error(t))}):n(new Error("\u8ba2\u5355\u53f7\u4e0d\u80fd\u4e3a\u7a7a"))})}var m=n(43258),b={class:"orders-container"},L={class:"orders-inner"},g={class:"dashboard-card welcome-card"},y={class:"card-header"},w={class:"card-title"},C={class:"card-body"},A={key:0,class:"orders-loading"},E={key:1,class:"orders-error"},R={key:2,class:"orders-content"},F={key:0,class:"pagination-container"},X={class:"pagination"},z=["disabled"],K={class:"page-info"},T=["disabled"],$={key:0,class:"swipe-hint"},x={class:"order-card-header"},Q={class:"order-number"},M={class:"label"},N={class:"value"},S={class:"status-wrapper"},D={class:"order-card-body"},I={class:"info-row"},W={class:"label"},O={class:"value"},j={class:"info-row"},q={class:"label"},B={class:"value"},H={class:"info-row"},J={class:"label"},P={class:"value amount"},U={class:"order-card-footer"},V=["onClick"],G=["onClick","disabled"],Z={class:"order-table"},Y={width:"22%"},ee={width:"16%"},te={width:"10%"},ne={width:"14%"},ae={width:"14%"},re={width:"24%"},oe={class:"trade-no"},se={class:"amount"},le={class:"actions"},ue=["onClick"],ce=["onClick","disabled"],ie={key:3,class:"orders-empty"},de={class:"modal-header"},ve={class:"modal-body"},pe={class:"trade-no-info"},ke={class:"trade-no"},fe={class:"modal-footer"},he=["disabled"],_e={key:0,class:"loader"};const me={__name:"OrderList",setup:function(e){var t=(0,i.s9)(),n=t.t,k=t.locale,f=(0,d.rd)(),me=(0,s.WQ)("$toast"),be=(0,u.KR)(!0),Le=(0,u.KR)(""),ge=(0,u.KR)([]),ye=(0,u.KR)(!1),we=(0,u.KR)(""),Ce=(0,u.KR)(!1),Ae=(0,u.KR)(!1),Ee=(0,u.KR)("left"),Re=(0,u.KR)("\xa5"),Fe=function(){Ae.value=window.innerWidth<768};window.addEventListener("resize",Fe);var Xe=(0,u.KR)(1),ze=(0,s.EW)(function(){return Math.ceil(ge.value.length/10)}),Ke=(0,s.EW)(function(){var e=10*(Xe.value-1),t=e+10;return ge.value.slice(e,t)}),Te=(0,u.KR)(0),$e=(0,u.KR)(0),xe=function(e){Te.value=e.touches[0].clientX},Qe=function(e){$e.value=e.touches[0].clientX},Me=function(){var e=$e.value-Te.value;Math.abs(e)>50&&(e>0?(Ee.value="right",Se()):(Ee.value="left",Ne())),Te.value=0,$e.value=0},Ne=function(){Xe.value<ze.value&&(Ee.value="left",Xe.value++)},Se=function(){Xe.value>1&&(Ee.value="right",Xe.value--)},De=function(){var e=(0,o.A)((0,r.A)().m(function e(){var t,a;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return be.value=!0,Le.value="",e.p=1,e.n=2,h();case 2:(t=e.v)&&t.data?(ge.value=t.data,Xe.value=1):ge.value=[],e.n=4;break;case 3:e.p=3,a=e.v,Le.value=a&&a.message?a.message:n("common.networkError")||"\u7f51\u7edc\u9519\u8bef",me&&me.error(Le.value);case 4:return e.p=4,be.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),Ie=function(e){return e?new Date(1e3*e).toLocaleString("zh-CN"===k.value?"zh-CN":"en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"--"},We=function(e){return e?{month_price:n("shop.plan.price_options.month")||"\u6708\u4ed8",quarter_price:n("shop.plan.price_options.quarter")||"\u5b63\u5ea6",half_year_price:n("shop.plan.price_options.half_year")||"\u534a\u5e74",year_price:n("shop.plan.price_options.year")||"\u4e00\u5e74",two_year_price:n("shop.plan.price_options.two_year")||"\u4e24\u5e74",three_year_price:n("shop.plan.price_options.three_year")||"\u4e09\u5e74",onetime_price:n("shop.plan.price_options.onetime")||"\u4e00\u6b21\u6027",reset_price:n("shop.plan.price_options.reset_price")||"\u91cd\u7f6e\u6d41\u91cf\u5305",deposit:n("shop.plan.price_options.deposit")||"\u5145\u503c"}[e]||e:"--"},Oe=function(e){return null==e?"--":Re.value+(e/100).toFixed(2)},je=(0,s.EW)(function(){return{0:n("orders.status.pending","\u5f85\u652f\u4ed8"),1:n("orders.status.processing","\u5f00\u901a\u4e2d"),2:n("orders.status.cancelled","\u5df2\u53d6\u6d88"),3:n("orders.status.completed","\u5df2\u5b8c\u6210"),4:n("orders.status.discounted","\u5df2\u6298\u62b5"),unknown:n("orders.status.unknown","\u672a\u77e5\u72b6\u6001")}}),qe=function(e){return je.value[e]||"".concat(je.value.unknown," (").concat(e,")")},Be=function(e){return{0:"status-pending",1:"status-processing",2:"status-cancelled",3:"status-completed",4:"status-discounted"}[e]||"status-unknown"},He=function(e){f.push({path:"/payment",query:{trade_no:e,from:"orders"}})},Je=function(e){we.value=e,ye.value=!0},Pe=function(){ye.value=!1},Ue=function(){var e=(0,o.A)((0,r.A)().m(function e(){var t,a;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(we.value&&!Ce.value){e.n=1;break}return e.a(2);case 1:return Ce.value=!0,e.p=2,e.n=3,_(we.value);case 3:me&&"function"==typeof me.success&&me.success(n("orders.cancelSuccess")||"\u8ba2\u5355\u5df2\u53d6\u6d88"),Pe(),De(),e.n=5;break;case 4:e.p=4,a=e.v,t=n("orders.cancelFailed")||"\u53d6\u6d88\u8ba2\u5355\u5931\u8d25";try{a&&("string"==typeof a?t=a:a instanceof Error?t=a.message||t:"string"==typeof a.message&&(t=a.message))}catch(e){}me&&"function"==typeof me.error?me.error(t):alert(t),Pe();case 5:return e.p=5,Ce.value=!1,e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(){return e.apply(this,arguments)}}(),Ve=(0,s.EW)(function(){return{tradeNo:n("orders.tradeNo","\u8ba2\u5355\u53f7"),createdAt:n("orders.createdAt","\u521b\u5efa\u65f6\u95f4"),cycle:n("orders.cycle","\u5468\u671f"),totalAmount:n("orders.totalAmount","\u91d1\u989d"),statusLabel:n("orders.statusLabel","\u72b6\u6001")||"\u72b6\u6001",actions:n("orders.actions","\u64cd\u4f5c"),viewDetail:n("orders.viewDetail","\u67e5\u770b\u8be6\u60c5"),cancel:n("orders.cancel","\u53d6\u6d88\u8ba2\u5355"),noOrders:n("orders.noOrders","\u6682\u65e0\u8ba2\u5355"),goShopping:n("orders.goShopping","\u53bb\u8d2d\u4e70\u5957\u9910"),loading:n("orders.loading","\u6b63\u5728\u52a0\u8f7d\u8ba2\u5355..."),cancelConfirmTitle:n("orders.cancelConfirmTitle","\u786e\u8ba4\u53d6\u6d88\u8ba2\u5355"),cancelConfirmText:n("orders.cancelConfirmText","\u60a8\u786e\u5b9a\u8981\u53d6\u6d88\u6b64\u8ba2\u5355\u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u9500\u3002")}}),Ge=function(){var e=(0,o.A)((0,r.A)().m(function e(){var t;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,m.l8)();case 1:(t=e.v)&&t.data&&t.data.currency_symbol&&(Re.value=t.data.currency_symbol),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();return(0,s.sV)(function(){Ge(),De(),Fe()}),(0,s.wB)(k,function(){ge.value.length>0&&(ge.value=(0,a.A)(ge.value))}),function(e,t){return(0,s.uX)(),(0,s.CE)("div",b,[(0,s.Lk)("div",L,[(0,s.Lk)("div",g,[(0,s.Lk)("div",y,[(0,s.Lk)("h2",w,(0,l.v_)(e.$t("orders.welcome.title")||"\u8ba2\u5355\u5217\u8868"),1)]),(0,s.Lk)("div",C,[(0,s.Lk)("p",null,(0,l.v_)(e.$t("orders.welcome.description")||"\u67e5\u770b\u5e76\u7ba1\u7406\u60a8\u7684\u8ba2\u5355"),1)])]),be.value?((0,s.uX)(),(0,s.CE)("div",A,[(0,s.bF)(v.A),(0,s.Lk)("p",null,(0,l.v_)(Ve.value.loading),1)])):Le.value?((0,s.uX)(),(0,s.CE)("div",E,[(0,s.bF)((0,u.R1)(p.QO),{size:48,class:"error-icon"}),(0,s.Lk)("p",null,(0,l.v_)(Le.value),1),(0,s.Lk)("button",{class:"retry-button",onClick:De},(0,l.v_)(e.$t("common.retry")||"\u91cd\u8bd5"),1)])):ge.value.length>0?((0,s.uX)(),(0,s.CE)("div",R,[ze.value>1?((0,s.uX)(),(0,s.CE)("div",F,[(0,s.Lk)("div",X,[(0,s.Lk)("button",{class:(0,l.C4)(["page-button prev",{disabled:1===Xe.value}]),onClick:Se,disabled:1===Xe.value},[(0,s.bF)((0,u.R1)(p.gu7),{size:16})],10,z),(0,s.Lk)("div",K,(0,l.v_)(e.$t("common.page")||"\u9875")+" "+(0,l.v_)(Xe.value)+" / "+(0,l.v_)(ze.value),1),(0,s.Lk)("button",{class:(0,l.C4)(["page-button next",{disabled:Xe.value===ze.value}]),onClick:Ne,disabled:Xe.value===ze.value},[(0,s.bF)((0,u.R1)(p.Vjx),{size:16})],10,T)])])):(0,s.Q3)("",!0),Ae.value?((0,s.uX)(),(0,s.CE)("div",{key:1,class:"order-cards",onTouchstart:xe,onTouchmove:Qe,onTouchend:Me},[ge.value.length>10?((0,s.uX)(),(0,s.CE)("div",$,[(0,s.bF)((0,u.R1)(p.Gk),{size:16,class:"swipe-icon"}),(0,s.Lk)("span",null,(0,l.v_)(e.$t("common.swipeHint")||"\u5de6\u53f3\u6ed1\u52a8\u5207\u6362"),1),(0,s.bF)((0,u.R1)(p.hIg),{size:16,class:"swipe-icon"})])):(0,s.Q3)("",!0),(0,s.bF)(c.F,{name:"right"===Ee.value?"page-switch-right":"page-switch"},{default:(0,s.k6)(function(){return[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Ke.value,function(e){return(0,s.uX)(),(0,s.CE)("div",{key:e.trade_no,class:"order-card"},[(0,s.Lk)("div",x,[(0,s.Lk)("div",Q,[(0,s.Lk)("span",M,(0,l.v_)(Ve.value.tradeNo)+":",1),(0,s.Lk)("span",N,(0,l.v_)(e.trade_no),1)]),(0,s.Lk)("div",S,[(0,s.Lk)("span",{class:(0,l.C4)(["status-badge",Be(e.status)])},(0,l.v_)(qe(e.status)),3)])]),(0,s.Lk)("div",D,[(0,s.Lk)("div",I,[(0,s.Lk)("span",W,(0,l.v_)(Ve.value.createdAt)+":",1),(0,s.Lk)("span",O,(0,l.v_)(Ie(e.created_at)),1)]),(0,s.Lk)("div",j,[(0,s.Lk)("span",q,(0,l.v_)(Ve.value.cycle)+":",1),(0,s.Lk)("span",B,(0,l.v_)(We(e.period)),1)]),(0,s.Lk)("div",H,[(0,s.Lk)("span",J,(0,l.v_)(Ve.value.totalAmount)+":",1),(0,s.Lk)("span",P,(0,l.v_)(Oe(e.total_amount)),1)])]),(0,s.Lk)("div",U,[(0,s.Lk)("button",{class:"action-button view-button",onClick:function(t){return He(e.trade_no)}},[(0,s.bF)((0,u.R1)(p.HvQ),{size:16}),(0,s.Lk)("span",null,(0,l.v_)(Ve.value.viewDetail),1)],8,V),(0,s.Lk)("button",{class:(0,l.C4)(["action-button cancel-button",{disabled:0!==e.status}]),onClick:function(t){return Je(e.trade_no)},disabled:0!==e.status},[(0,s.bF)((0,u.R1)(p.MRt),{size:16}),(0,s.Lk)("span",null,(0,l.v_)(Ve.value.cancel),1)],10,G)])])}),128))]}),_:1},8,["name"])],32)):((0,s.uX)(),(0,s.CE)("div",{key:2,class:"order-table-container",onTouchstart:xe,onTouchmove:Qe,onTouchend:Me},[(0,s.Lk)("table",Z,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",Y,(0,l.v_)(Ve.value.tradeNo),1),(0,s.Lk)("th",ee,(0,l.v_)(Ve.value.createdAt),1),(0,s.Lk)("th",te,(0,l.v_)(Ve.value.cycle),1),(0,s.Lk)("th",ne,(0,l.v_)(Ve.value.totalAmount),1),(0,s.Lk)("th",ae,(0,l.v_)(Ve.value.statusLabel),1),(0,s.Lk)("th",re,(0,l.v_)(Ve.value.actions),1)])]),(0,s.Lk)("tbody",null,[(0,s.bF)(c.F,{name:"right"===Ee.value?"page-switch-right":"page-switch"},{default:(0,s.k6)(function(){return[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Ke.value,function(e){return(0,s.uX)(),(0,s.CE)("tr",{key:e.trade_no},[(0,s.Lk)("td",oe,(0,l.v_)(e.trade_no),1),(0,s.Lk)("td",null,(0,l.v_)(Ie(e.created_at)),1),(0,s.Lk)("td",null,(0,l.v_)(We(e.period)),1),(0,s.Lk)("td",se,(0,l.v_)(Oe(e.total_amount)),1),(0,s.Lk)("td",null,[(0,s.Lk)("span",{class:(0,l.C4)(["status-badge",Be(e.status)])},(0,l.v_)(qe(e.status)),3)]),(0,s.Lk)("td",le,[(0,s.Lk)("button",{class:"action-button view-button",onClick:function(t){return He(e.trade_no)}},[(0,s.bF)((0,u.R1)(p.HvQ),{size:16}),(0,s.Lk)("span",null,(0,l.v_)(Ve.value.viewDetail),1)],8,ue),(0,s.Lk)("button",{class:(0,l.C4)(["action-button cancel-button",{disabled:0!==e.status}]),onClick:function(t){return Je(e.trade_no)},disabled:0!==e.status},[(0,s.bF)((0,u.R1)(p.MRt),{size:16}),(0,s.Lk)("span",null,(0,l.v_)(Ve.value.cancel),1)],10,ce)])])}),128))]}),_:1},8,["name"])])])],32))])):((0,s.uX)(),(0,s.CE)("div",ie,[(0,s.bF)((0,u.R1)(p.AMT),{size:48,class:"empty-icon"}),(0,s.Lk)("p",null,(0,l.v_)(Ve.value.noOrders),1),(0,s.Lk)("button",{class:"shop-button",onClick:t[0]||(t[0]=function(t){return e.$router.push("/shop")})},[(0,s.bF)((0,u.R1)(p.AMT),{size:16}),(0,s.Lk)("span",null,(0,l.v_)(Ve.value.goShopping),1)])])),(0,s.bF)(c.eB,{name:"modal-fade"},{default:(0,s.k6)(function(){return[ye.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"modal-overlay",onClick:Pe},[(0,s.Lk)("div",{class:"modal-content",onClick:t[1]||(t[1]=(0,c.D$)(function(){},["stop"]))},[(0,s.Lk)("div",de,[(0,s.Lk)("h3",null,(0,l.v_)(Ve.value.cancelConfirmTitle),1),(0,s.Lk)("button",{class:"modal-close",onClick:Pe},[(0,s.bF)((0,u.R1)(p.MRt),{size:20})])]),(0,s.Lk)("div",ve,[(0,s.Lk)("p",null,(0,l.v_)(Ve.value.cancelConfirmText),1),(0,s.Lk)("div",pe,[(0,s.Lk)("span",null,(0,l.v_)(Ve.value.tradeNo)+":",1),(0,s.Lk)("span",ke,(0,l.v_)(we.value),1)])]),(0,s.Lk)("div",fe,[(0,s.Lk)("button",{class:"btn-cancel",onClick:Pe},(0,l.v_)(e.$t("common.cancel")||"\u53d6\u6d88"),1),(0,s.Lk)("button",{class:"btn-confirm",onClick:Ue,disabled:Ce.value},[Ce.value?((0,s.uX)(),(0,s.CE)("span",_e)):(0,s.Q3)("",!0),(0,s.Lk)("span",null,(0,l.v_)(e.$t("common.confirm")||"\u786e\u8ba4"),1)],8,he)])])])):(0,s.Q3)("",!0)]}),_:1})])])}}};const be=(0,n(66262).A)(me,[["__scopeId","data-v-362fe809"]])}}]);